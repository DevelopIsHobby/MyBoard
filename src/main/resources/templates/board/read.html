<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Get Page</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <style>
        body {
            padding-top : 80px;
        }
        .uploadResult {
            width: 100%;
            background-color: grey;
            margin-top: 10px;
        }
        .uploadResult ul {
            display: flex;
            flex-flow : row;
            justify-content: center;
            align-items: center;
            vertical-align: top;
            overflow: auto;
        }
        .uploadResult ul li {
            list-style : none;
            padding : 10px;
            margin-left : 2em;
        }
        .uploadResult ul li img {
            width : 100px;
        }
    </style>
</head>
<body>
    <div class="navbar navbar-dark bg-dark fixed-top navbar-expand-lg">
        <div class="container">
            <a class="navbar-brand" href="#">Bootstrap</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-content">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbar-content">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item dropdown">
                        <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">HTML</a>
                        <div class="dropdown-menu">
                            <a href="#" class="dropdown-item">Geolocation</a>
                            <a href="#" class="dropdown-item">Drag and Drop</a>
                            <div class="dropdown-divider"></div>
                            <a href="#" class="dropdown-item">Motion</a>
                        </div>
                    </li>
                    <li class="nav-item"><a href="#" class="nav-link">CSS3</a></li>
                    <li class="nav-item"><a href="#" class="nav-link">ECMAScript</a></li>
                    <li class="nav-item"><a href="#" class="nav-link">Node.js</a></li>
                    <li class="nav-item"><a href="#" class="nav-link">API</a></li>
                </ul>
                <form action="" class="form-inline">
                    <input type="text" class="form-control" placeholder="Search"/>
                </form>
                <ul class="navbar-nav">
                    <li class="nav-item"><a href="#" class="nav-link">Node.js</a></li>
                    <li class="nav-item"><a href="#" class="nav-link">API</a></li>
                </ul>
            </div>
        </div>
    </div>

    <h1 class="text-center">Board Read Page</h1>
    <div class="col-6 offset-3">
        <div class="mb-3">
            <label class="form-label" for="title">Title</label>
            <input class="form-control" type="text" id="title" name="title" th:value="${board.title}" readonly>
        </div>
        <div class="mb-3">
            <label class="form-label" for="">Content</label>
            <textarea class="form-control" name="content" id="" cols="20" rows="5" readonly>[[${board.content}]]</textarea>
        </div>

        <div class="mb-3">
            <label class="form-label" for="tags"><small>Tags</small></label>
            <input class="form-control" type="text" id="tags" name="tags" th:value="'#' + ${tags}" readonly>
        </div>


        <div class="mb-3">
            <label class="form-label" for="" >Writer</label>
            <input class="form-control" type="text" id="writer" name="writerEmail" th:value="${board.writerEmail}" readonly>
        </div>


        <div class="mb-3">
            <label class="form-label" for="" >ModDate</label>
            <input class="form-control" type="text"  name="modDate" th:value="${board.modDate}" readonly>
        </div>
        <a th:href="@{/board/modify(bno=${board.bno})}">
            <button type="button" class="btn btn-primary">Modify</button>
        </a>

        <button type="button" class="btn btn-info listBtn">List</button>
        <div class="uploadResult">
            <ul>
                <li th:each="boardImage : ${board.imageDTOList}">
<!--                    <img th:if="${boardImage.path != null}" th:src="|/display?fileName=${boardImage.getThumbnailURL()}|">-->
                    <input class="form-control" type="text"  name="imgName" th:value="${boardImage.imgName}" readonly>
                </li>
            </ul>
        </div>
        <div>
            <div class="mt-4">
                <h5>
                    <span class="badge text-bg-secondary">Reply Count 0</span>
                </h5>
            </div>

            <div class="light-group replyList"></div>

        </div>


    </div>
</div>

<script>

    // 현재 시간과의 차이를 계산하여 포맷팅하는 함수
    function formatTimeDifference(dateString) {
        const date = new Date(dateString);
        const currentDate = new Date();
        const diff = currentDate - date;

        const diffMinutes = Math.floor(diff / 60000); // milliseconds to minutes
        const diffHours = Math.floor(diff / 3600000); // milliseconds to hours
        const diffDays = Math.floor(diff / 86400000); // milliseconds to days

        if (diffDays > 0) {
            return date.getFullYear() + '. ' + (date.getMonth() + 1) + '. ' + date.getDate();
        } else if (diffHours > 0) {
            return diffHours + '시간 전';
        } else if (diffMinutes > 0) {
            return diffMinutes + '분 전';
        } else {
            return '방금 전';
        }
    }

    // 페이지가 로드되면 날짜를 형식화합니다.
    document.addEventListener('DOMContentLoaded', function () {
        const modDateInput = document.querySelector('input[name="modDate"]');
        const formattedDate = formatTimeDifference(modDateInput.value);
        modDateInput.value = formattedDate;


        // 무한스크롤 원래 있던 스크롤 위치 복원(뒤로가기 구현)
        const listButton = document.querySelector(".listBtn");

        listButton.addEventListener("click", function() {
            window.history.back(); // 브라우저의 이전 페이지로 이동
        });
    });
</script>
</body>
</html>